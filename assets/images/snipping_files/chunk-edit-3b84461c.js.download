System.register(["./chunk-vendor.js","./chunk-frameworks.js"],function(x){"use strict";var g,l,a,E,T,C,h,b,F;return{setters:[function(m){g=m.o,l=m.a,a=m.r,E=m.f},function(m){T=m.c,C=m.h,h=m.e,b=m.u,F=m.g}],execute:function(){x("h",z);var m=Object.defineProperty,d=(e,n)=>m(e,"name",{value:n,configurable:!0});let f=[];g(".js-comment-header-actions-deferred-include-fragment",{subscribe:e=>T(e,"loadstart",()=>{const n=e.closest(".js-comment");S(n)},{capture:!1,once:!0})}),g(".js-comment .contains-task-list",{add:e=>{const n=e.closest(".js-comment");S(n)}}),l("click",".js-comment-edit-button",function(e){const n=e.currentTarget.closest(".js-comment");n.classList.add("is-comment-editing");const s=L(n);s?s.addEventListener("include-fragment-replaced",()=>q(n),{once:!0}):q(n);const t=e.currentTarget.closest(".js-dropdown-details");t&&t.removeAttribute("open")});function q(e){e.querySelector(".js-write-tab").click();const n=e.querySelector(".js-comment-field");n.focus(),E(n,"change")}d(q,"focusEditForm");function L(e){return e.querySelector(".js-comment-edit-form-deferred-include-fragment")}d(L,"findEditFormDeferredIncludeFragment");function S(e){L(e)?.setAttribute("loading","eager")}d(S,"loadEditFormDeferredIncludeFragment"),l("click",".js-comment-hide-button",function(e){const n=e.currentTarget.closest(".js-comment");w(n,!1);const s=n.querySelector(".js-minimize-comment");s&&s.classList.remove("d-none");const t=e.currentTarget.closest(".js-dropdown-details");t&&t.removeAttribute("open")}),l("click",".js-comment-hide-minimize-form",function(e){e.currentTarget.closest(".js-minimize-comment").classList.add("d-none")});function z(e){const n=e.currentTarget.closest("form"),s=e.currentTarget.getAttribute("data-confirm-text");if(C(n)&&!confirm(s))return!1;for(const o of n.querySelectorAll("input, textarea")){const r=o;r.value=r.defaultValue,r.classList.contains("session-resumable-canceled")&&(r.classList.add("js-session-resumable"),r.classList.remove("session-resumable-canceled"))}const t=e.currentTarget.closest(".js-comment");return t&&t.classList.remove("is-comment-editing"),!0}d(z,"handleCommentCancelButtonClick"),l("click",".js-comment-cancel-button",z),l("click",".js-cancel-issue-edit",function(e){const n=e.currentTarget.closest(".js-details-container");n.querySelector(".js-comment-form-error").hidden=!0}),a(".js-comment-delete, .js-comment .js-comment-update, .js-issue-update, .js-comment-minimize, .js-comment-unminimize",function(e,n,s){const t=e.closest(".js-comment");t.classList.add("is-comment-loading");const o=t.getAttribute("data-body-version");o&&s.headers.set("X-Body-Version",o)}),a(".js-comment .js-comment-update",async function(e,n){let s;const t=e.closest(".js-comment"),o=t.querySelector(".js-comment-update-error"),r=t.querySelector(".js-comment-body-error");o instanceof HTMLElement&&(o.hidden=!0),r instanceof HTMLElement&&(r.hidden=!0),f=[];try{s=await n.json()}catch(u){if(u.response.status===422){const p=JSON.parse(u.response.text);if(p.errors){o instanceof HTMLElement&&(o.textContent=`There was an error posting your comment: ${p.errors.join(", ")}`,o.hidden=!1);return}}else throw u}if(!s)return;const i=s.json;i.errors&&i.errors.length>0&&(f=i.errors,v(r));const j=t.querySelector(".js-comment-body");j&&i.body&&(j.innerHTML=i.body),t.setAttribute("data-body-version",i.newBodyVersion);const y=t.querySelector(".js-body-version");y instanceof HTMLInputElement&&(y.value=i.newBodyVersion);for(const u of t.querySelectorAll("input, textarea")){const p=u;p.defaultValue=p.value}t.classList.remove("is-comment-stale","is-comment-editing");const c=t.querySelector(".js-comment-edit-history");if(c){const u=await h(document,i.editUrl);c.innerHTML="",c.append(u)}}),g(".js-comment-body-error",{add:e=>{f&&f.length>0&&v(e)}});function v(e){const n=e.querySelector("ol");if(n){n.innerHTML="";const s=f.map(t=>{const o=document.createElement("li");return o.textContent=t,o});for(const t of s)n.appendChild(t)}e.hidden=!1}d(v,"showBodyErrors"),a(".js-comment .js-comment-delete, .js-comment .js-comment-update, .js-comment-minimize, .js-comment-unminimize",async function(e,n){const s=e.closest(".js-comment");try{await n.text()}catch(t){if(t.response.status===422){let o;try{o=JSON.parse(t.response.text)}catch{}o&&o.stale&&s.classList.add("is-comment-stale")}else throw t}s.classList.remove("is-comment-loading")});function w(e,n){const s=e.querySelector(".js-comment-show-on-error");s&&(s.hidden=!n);const t=e.querySelector(".js-comment-hide-on-error");t&&(t.hidden=n)}d(w,"toggleMinimizeError"),a(".js-timeline-comment-unminimize, .js-timeline-comment-minimize",async function(e,n){const s=e.closest(".js-minimize-container");try{const t=await n.html();s.replaceWith(t.html)}catch{w(s,!0)}}),a(".js-discussion-comment-unminimize, .js-discussion-comment-minimize",async function(e,n){const s=e.closest(".js-discussion-comment"),t=s.querySelector(".js-discussion-comment-error");t&&(t.hidden=!0);try{const o=await n.html();s.replaceWith(o.html)}catch(o){if(o.response.status>=400&&o.response.status<500){if(o.response.html){const r=o.response.html.querySelector(".js-discussion-comment").getAttribute("data-error");t instanceof HTMLElement&&(t.textContent=r,t.hidden=!1)}}else throw o}}),a(".js-comment-delete",async function(e,n){await n.json();let s=e.closest(".js-comment-delete-container");s||(s=e.closest(".js-comment-container")||e.closest(".js-line-comments"),s&&s.querySelectorAll(".js-comment").length!==1&&(s=e.closest(".js-comment"))),s.remove()}),a(".js-issue-update",async function(e,n){const s=e.closest(".js-details-container"),t=s.querySelector(".js-comment-form-error");let o;try{o=await n.json()}catch(i){t.textContent=i.response?.json?.errors?.[0]||"Something went wrong. Please try again.",t.hidden=!1}if(!o)return;s.classList.remove("open"),t.hidden=!0;const r=o.json;if(r.issue_title!=null){s.querySelector(".js-issue-title").textContent=r.issue_title;const i=s.closest(".js-issues-results");if(i){if(i.querySelector(".js-merge-pr.is-merging")){const c=i.querySelector(".js-merge-pull-request textarea");c instanceof HTMLTextAreaElement&&c.value===c.defaultValue&&(c.value=c.defaultValue=r.issue_title)}else if(i.querySelector(".js-merge-pr.is-squashing")){const c=i.querySelector(".js-merge-pull-request .js-merge-title");c instanceof HTMLInputElement&&c.value===c.defaultValue&&(c.value=c.defaultValue=r.default_squash_commit_title)}const j=i.querySelector("button[value=merge]");j&&j.setAttribute("data-input-message-value",r.issue_title);const y=i.querySelector("button[value=squash]");y&&y.setAttribute("data-input-title-value",r.default_squash_commit_title)}}document.title=r.page_title;for(const i of e.elements)(i instanceof HTMLInputElement||i instanceof HTMLTextAreaElement)&&(i.defaultValue=i.value)}),a(".js-comment-minimize",async function(e,n){await n.json();const s=e.closest(".js-comment"),t=s.querySelector(".js-minimize-comment");if(t&&t.classList.contains("js-update-minimized-content")){const o=e.querySelector("input[type=submit], button[type=submit]");o&&o.classList.add("disabled");const r=s.closest(".js-comment-container");r&&await b(r)}else{t&&t.classList.add("d-none");const o=e.closest(".unminimized-comment");o.classList.add("d-none"),o.classList.remove("js-comment");const i=e.closest(".js-minimizable-comment-group").querySelector(".minimized-comment");i&&i.classList.remove("d-none"),i&&i.classList.add("js-comment")}}),a(".js-comment-unminimize",async function(e,n){await n.json();const s=e.closest(".js-minimizable-comment-group"),t=s.querySelector(".unminimized-comment"),o=s.querySelector(".minimized-comment");if(t)t.classList.remove("d-none"),t.classList.add("js-comment"),o&&o.classList.add("d-none"),o&&o.classList.remove("js-comment");else{if(o){const i=o.querySelector(".timeline-comment-actions");i&&i.classList.add("d-none"),o.classList.remove("js-comment")}const r=s.closest(".js-comment-container");await b(r)}}),l("details-menu-select",".js-comment-edit-history-menu",e=>{const n=e.detail.relatedTarget.getAttribute("data-edit-history-url");if(!n)return;e.preventDefault();const s=h(document,n);F({content:s,dialogClass:"Box-overlay--wide"})},{capture:!0})}}});
//# sourceMappingURL=chunk-edit-6af484f5.js.map
